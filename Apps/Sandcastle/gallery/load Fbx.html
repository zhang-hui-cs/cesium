<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"> <!-- Use Chrome Frame in IE -->
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="description" content="Adjust the height of a 3D Tiles tileset.">
    <meta name="cesium-sandcastle-labels" content="3D Tiles">
    <title>Cesium Demo</title>
    <script type="text/javascript" src="../Sandcastle-header.js"></script>
    <script type="text/javascript" src="../../../Build/CesiumUnminified/Cesium.js" nomodule></script>
    <script type="module" src="../load-cesium-es6.js"></script>
</head>

<body class="sandcastle-loading" data-sandcastle-bucket="bucket-requirejs.html">
    <style>
        @import url(../templates/bucket.css);

        #toolbar {
            background: rgba(42, 42, 42, 0.8);
            padding: 4px;
            border-radius: 4px;
        }

        #toolbar input {
            vertical-align: middle;
            padding-top: 2px;
            padding-bottom: 2px;
        }
    </style>
    <div id="cesiumContainer" class="fullSize"></div>
    <script id="cesium_sandcastle_script">

        function initialViewer(element) {
            const newViewer = new Cesium.Viewer(element, {
                baseLayerPicker: false,
                fullscreenButton: false,
                homeButton: false,
                sceneModePicker: false,
                selectionIndicator: false,
                timeline: false,
                animation: false,
                navigationHelpButton: false,
                infoBox: false,
                geocoder: false,
                targetFrameRate: 25,
                imageryProvider: new Cesium.WebMapTileServiceImageryProvider({
                    url:
                        'http://t0.tianditu.gov.cn/img_w/wmts?tk=9d2964079a8920b154e7bebe798f80ca',
                    layer: 'img',
                    style: 'default',
                    tileMatrixSetID: 'w',
                    format: 'tiles',
                    maximumLevel: 18,
                }),
            });

            newViewer.scene.debugShowFramesPerSecond = true;

            return newViewer;
        }

        function add3dTileset(viewer) {
            const tileset = viewer.scene.primitives.add(
                new Cesium.Cesium3DTileset({
                    url: "http://10.14.3.198:2001/test/Block/tileset.json",
                    // url: 'http://localhost:2001/osgb/KFC/tileset.json',
                    // maximumMemoryUsage: 512,
                    // debugShowMemoryUsage: true
                })
            );

            viewer.flyTo(tileset);
        }

        function startup(Cesium) {
            const viewer = initialViewer('cesiumContainer');
            add3dTileset(viewer);
        }

        function setSSE(viewer, sse) {
            const primitives = viewer.scene.primitives;
            for (let i = 0; i < primitives.length; i++) {
                const item = primitives.get(i);
                if (item instanceof Cesium.Cesium3DTileset) {
                    item.maximumScreenSpaceError = sse;
                }
            }
        }

        if (typeof Cesium !== 'undefined') {
            window.startupCalled = true;
            startup(Cesium);
        }
    </script>
</body>

</html>
